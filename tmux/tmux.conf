# Prefix and shell
set -g default-shell /bin/zsh
set -g default-command "exec /bin/zsh"
unbind C-b
set -g prefix C-a
bind C-a send-prefix
set -g repeat-time 0
set -g base-index 1
set -g pane-base-index 1
set -g renumber-windows on

# Clipboard, mouse, and focus
set -g set-clipboard on
set -g mouse on
set -g focus-events on
setw -g mode-keys vi
set -g status-keys vi

# History and responsiveness
set -g history-limit 10000
set -sg escape-time 0
set -g status-interval 1

# Terminal capabilities (truecolor + undercurl)
set -g default-terminal "tmux-256color"
set -as terminal-overrides ",xterm-256color:Tc"
set -as terminal-overrides ",screen-256color:Tc"
set -as terminal-overrides ",*:Smulx=\E[4::%p1%dm,Setulc=\E[58::2::%p1%{65536}%/%d::%p1%{256}%/%{255}%&%d::%p1%{255}%&%d%"

# Splits and windows in current directory
bind '"' split-window -v -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"

# Navigation and resize (vim-like)
bind -n C-h select-pane -L
bind -n C-j select-pane -D
bind -n C-k select-pane -U
bind -n C-l select-pane -R
bind -n M-Left resize-pane -L 5
bind -n M-Right resize-pane -R 5
bind -n M-Up resize-pane -U 2
bind -n M-Down resize-pane -D 2

# Utilities
bind -n C-l send-keys C-l
bind C-k clear-history
bind-key R switch-client -r

# Activity
set -g monitor-activity on
set -g visual-activity on

# Nord theme (matches Ghostty)
set -g status-style "fg=#D8DEE9,bg=#2E3440"
set -g message-style "fg=#2E3440,bg=#81A1C1"
set -g message-command-style "fg=#2E3440,bg=#81A1C1"
set -g pane-border-style "fg=#4C566A"
set -g pane-active-border-style "fg=#81A1C1"
setw -g window-status-style "fg=#E5E9F0,bg=#2E3440"
setw -g window-status-current-style "fg=#2E3440,bg=#81A1C1,bold"
set -g status-left-length 40
set -g status-right-length 120
set -g status-left '#[fg=#2E3440,bg=#81A1C1,bold] #S #[fg=#81A1C1,bg=#2E3440,nobold]'
set -g status-right '#[fg=#81A1C1]#[fg=#2E3440,bg=#81A1C1,bold] %Y-%m-%d %H:%M #[fg=#D8DEE9,bg=#2E3440]'

# Plugins (TPM)
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'christoomey/vim-tmux-navigator'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Session persistence
set -g @resurrect-capture-pane-contents 'on'
set -g @continuum-restore 'on'
set -g @continuum-save-interval '15'

# Initialize TPM (keep at bottom)
run '~/.tmux/plugins/tpm/tpm'